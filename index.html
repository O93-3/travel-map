
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Travel Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="manifest" href="./manifest.json">
  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="stylesheet" href="./style.css">
<link rel="stylesheet" href="./style.cityresults.fix.css">
  <link rel="stylesheet" href="./style.routeoverlay.drag.css">
  <link rel="stylesheet" href="./style.overlay.fontsize.all.css">
</head>
<body>
  <div id="map"></div>

  <!-- 現在地 -->
  <div id="currentLocation">
    <img id="flag" alt="flag">
    <div id="currentText">
      <span id="currentCountry"></span>
      <span id="currentCity"></span>
    </div>
  </div>

  <!-- 配信インジケータ & SafeFrame -->
  <div id="streamIndicator"><span class="dot"></span> LIVE</div>
  <div id="safeFrame"><div class="sf" data-sf="title"></div><div class="sf" data-sf="action"></div></div>

  <!-- ルートオーバーレイ -->
  <div id="routeOverlay">
    <div class="ro-head"><div class="ro-title">ROUTE</div><div id="roProgress" class="ro-progress">0/0</div></div>
    <div class="ro-main">
      <div class="ro-block">
        <div class="ro-line1"><div class="ro-label">NOW</div><div id="roNowCity" class="ro-value">-</div></div>
        <div class="ro-line2"><img id="roNowFlag" class="ro-flag" alt="flag"><div id="roNowCountry" class="ro-country">-</div></div>
      </div>
      <div class="ro-block">
        <div class="ro-line1"><div class="ro-label">FROM</div><div id="roFromCity" class="ro-value">-</div></div>
        <div class="ro-line2"><img id="roFromFlag" class="ro-flag" alt="flag"><div id="roFromCountry" class="ro-country">-</div></div>
      </div>
      <div id="roHistory" class="ro-history"></div>
    </div>
  </div>

  <!-- メニュー（折り畳み、Redoなし） -->
  <div id="ui">
    <button id="langBtn">日本語</button>
    <button id="streamBtn">配信モード</button>

    <details class="ui-group"><summary class="ui-title">現在の状態</summary>
      <button id="exportBtn">現在の状態を保存</button>
      <button id="importBtn">保存した状態を読み込み</button>
      <input id="importFile" type="file" accept="application/json" style="display:none">
    </details>

<!-- Route section (search moved to the top) -->
<details class="ui-group"><summary class="ui-title">ルート</summary>
  <!-- 検索を最上段へ配置 -->
  <div class="searchWrap" style="margin-bottom:8px;">
    <input id="citySearch" placeholder="都市名・国名で検索">
    <div id="cityResults" class="city-results"></div>
  </div>

  <!-- 地域／国セレクト -->
  <select id="regionSelect"><option value="">地域</option></select>
  <select id="countrySelect"><option value="">国</option></select>

  <!-- 都市セレクト／操作 -->
  <select id="citySelect"><option value="">都市</option></select>
  <button id="addBtn">追加</button>
  <button id="undoBtn">ひとつ戻す</button>
  <button id="cancelInsertBtn">挿入解除</button>
  <div>挿入モード: <span id="insertModeLabel">OFF</span></div>
  <ol id="routeList" class="route-list"></ol>
  <button id="resetHistoryBtn" class="danger">ルート履歴をリセット</button>
</details>


    <details class="ui-group"><summary class="ui-title">地図</summary>
      <select id="mapStyleSelect">
        <option value="osm">標準</option>
        <option value="bw">白黒</option>
        <option value="sat">衛星</option>
        <option value="topo">地形</option>
      </select>
      <button id="toggleBorders">国境色分け ON/OFF</button>
    </details>

    <details class="ui-group"><summary class="ui-title">現在地</summary>
      <label><input id="showLocation" type="checkbox"> 現在地表示</label>
      <button id="lockLocationBtn">位置ロック: OFF</button>
      <label class="col"><span>現在地サイズ</span><input id="currentMarkerSize" type="range" min="8" max="60" value="20"></label>
      <label class="col"><span>現在地テキストサイズ</span><input id="locFontSize" type="range" min="12" max="40" value="18"></label>
      <label class="col"><span>旗サイズ</span><input id="locFlagSize" type="range" min="12" max="96" value="24"></label>
      <label class="col"><span>パディング</span><input id="locPadding" type="range" min="4" max="40" value="10"></label>
      <label class="col"><span>ルート線の色</span><input id="lineColor" type="color" value="#ff3333"></label>
      <label class="col"><span>ルート線の太さ</span><input id="lineWeight" type="range" min="1" max="12" value="4"></label>
      <label class="col"><span>現在地マーカー色</span><input id="currentMarkerColor" type="color" value="#00ffff"></label>
      <label class="col"><span>過去マーカー色</span><input id="pastMarkerColor" type="color" value="#ff3333"></label>
    </details>

    <details class="ui-group"><summary class="ui-title">ルートオーバーレイ</summary>
      <label><input id="showRouteOverlay" type="checkbox" checked> オーバーレイ表示</label>
      <label class="col"><span>オーバーレイ文字サイズ</span><input id="overlayFontSize" type="range" min="12" max="40" value="18"></label>
      <label class="col"><span>国旗サイズ</span><input id="overlayFlagSize" type="range" min="12" max="96" value="22"></label>
      <label><input id="overlayOnlyInStream" type="checkbox"> 配信モード中のみ表示</label>
      <label><input id="obsSafeFrame" type="checkbox"> セーフフレーム表示</label>
    </details>
  </div>

  <!-- Leaflet & Scripts（app.js → extensions.js の順） -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="./app.js"></script>
  <script src="./js/extensions.js"></script>
  <script src="./js/fix-lineweight.js"></script>
    <script src="./js/draggable-routeoverlay.js"></script>
        <script src="./js/overlay-fontsize.all.js"></script>
</body>
</html>
